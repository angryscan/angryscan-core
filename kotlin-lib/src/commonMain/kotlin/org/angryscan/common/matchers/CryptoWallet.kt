package org.angryscan.common.matchers

import kotlinx.serialization.Serializable
import org.angryscan.common.engine.hyperscan.IHyperMatcher
import org.angryscan.common.engine.ExpressionOption
import org.angryscan.common.engine.kotlin.IKotlinMatcher

@Serializable
object CryptoWallet : IHyperMatcher, IKotlinMatcher {
    override val name = "Crypto Wallet Address"
    
    override val javaPatterns = listOf(
        // Bitcoin (BTC) - Legacy P2PKH/P2SH addresses (starts with 1 or 3)
        """(?:(?<![\w\d])(?:^|\s)|(?<![\d\w])[\(\)\[\]\{\}\"'=]|(?<![\d\w])[#=\-\(\)\[\]\{\}\"'.,;!?]\s|:\s)(?<![\d])[13][a-km-zA-HJ-NP-Z1-9]{25,34}(?=(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)(?![\w\d]))""",
        
        // Bitcoin (BTC) - Bech32 addresses (starts with bc1)
        """(?:(?<![\w\d])(?:^|\s)|(?<![\d])[\(\)\[\]\{\}\"'=]|(?<![\d])[#=\-\(\)\[\]\{\}\"'.,;!?]\s|:\s)bc1[a-z0-9]{39,59}(?=(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)(?!\w))""",
        
        // Ethereum (ETH) and EVM-compatible chains (Polygon, BSC, Avalanche, etc.)
        """(?:(?<![\w\d])(?:^|\s)|(?<![\d])[\(\)\[\]\{\}\"'=]|(?<![\d])[#=\-\(\)\[\]\{\}\"'.,;!?]\s|:\s)0x[a-fA-F0-9]{40}(?=(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)(?!\w))""",
        
        // Litecoin (LTC) - Legacy addresses
        """(?:(?<![\w\d])(?:^|\s)|(?<![\d])[\(\)\[\]\{\}\"'=]|(?<![\d])[#=\-\(\)\[\]\{\}\"'.,;!?]\s|:\s)[LM][a-km-zA-HJ-NP-Z1-9]{26,34}(?=(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)(?!\w))""",
        
        // Litecoin (LTC) - Bech32 addresses (starts with ltc1)
        """(?:(?<![\w\d])(?:^|\s)|(?<![\d])[\(\)\[\]\{\}\"'=]|(?<![\d])[#=\-\(\)\[\]\{\}\"'.,;!?]\s|:\s)ltc1[a-z0-9]{39,59}(?=(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)(?!\w))""",
        
        // Ripple (XRP)
        """(?:(?<![\w\d])(?:^|\s)|(?<![\d])[\(\)\[\]\{\}\"'=]|(?<![\d])[#=\-\(\)\[\]\{\}\"'.,;!?]\s|:\s)r[a-zA-Z0-9]{24,34}(?=(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)(?!\w))""",
        
        // Bitcoin Cash (BCH) - Legacy format
        """(?:(?<![\w\d])(?:^|\s)|(?<![\d])[\(\)\[\]\{\}\"'=]|(?<![\d])[#=\-\(\)\[\]\{\}\"'.,;!?]\s|:\s)(?:bitcoincash:)?[qp][a-z0-9]{41}(?=(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)(?!\w))""",
        
        // Bitcoin Cash (BCH) - CashAddr format
        """(?:(?<![\w\d])(?:^|\s)|(?<![\d])[\(\)\[\]\{\}\"'=]|(?<![\d])[#=\-\(\)\[\]\{\}\"'.,;!?]\s|:\s)(?:bitcoincash:)?[qp][a-z]{10}[0-9a-z]{31}(?=(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)(?!\w))""",
        
        // Dogecoin (DOGE)
        """(?:(?<![\w\d])(?:^|\s)|(?<![\d])[\(\)\[\]\{\}\"'=]|(?<![\d])[#=\-\(\)\[\]\{\}\"'.,;!?]\s|:\s)D[5-9A-HJ-NP-U][1-9A-HJ-NP-Za-km-z]{32}(?=(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)(?!\w))""",
        
        // Tron (TRX)
        """(?:(?<![\w\d])(?:^|\s)|(?<![\d])[\(\)\[\]\{\}\"'=]|(?<![\d])[#=\-\(\)\[\]\{\}\"'.,;!?]\s|:\s)T[A-Za-z1-9]{33}(?=(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)(?!\w))""",
        
        // Monero (XMR) - Standard address (95 characters)
        """(?:(?<![\w\d])(?:^|\s)|(?<![\d])[\(\)\[\]\{\}\"'=]|(?<![\d])[#=\-\(\)\[\]\{\}\"'.,;!?]\s|:\s)[48][0-9AB][1-9A-HJ-NP-Za-km-z]{93}(?=(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)(?!\w))""",
        
        // Solana (SOL) - Base58 encoded
        // Exclude addresses that start with 1 or 3 and have length 34 (Bitcoin) or start with L or M and have length 34 (Litecoin)
        // Only exclude exact length 34 to avoid blocking shorter Bitcoin/Litecoin addresses
        """(?:(?<![\w\d])(?:^|\s)|(?<![\d])[\(\)\[\]\{\}\"'=]|(?<![\d])[#=\-\(\)\[\]\{\}\"'.,;!?]\s|:\s)(?![13][a-km-zA-HJ-NP-Z1-9]{34})(?![LM][a-km-zA-HJ-NP-Z1-9]{34})[1-9A-HJ-NP-Za-km-z]{32,44}(?=(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)(?!\w))""",
        
        // Stellar (XLM)
        """(?:(?<![\w\d])(?:^|\s)|(?<![\d])[\(\)\[\]\{\}\"'=]|(?<![\d])[#=\-\(\)\[\]\{\}\"'.,;!?]\s|:\s)G[A-Z0-9]{55}(?=(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)(?!\w))""",
        
        // Cardano (ADA) - Bech32 format (starts with addr1)
        // Limited to {40} to match hyperPatterns (max quantifier = 40)
        """(?:(?<![\w\d])(?:^|\s)|(?<![\d])[\(\)\[\]\{\}\"'=]|(?<![\d])[#=\-\(\)\[\]\{\}\"'.,;!?]\s|:\s)addr1[a-z0-9]{40}(?=(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)(?!\w))""",
        
        // Polkadot (DOT) - SS58 format
        """(?:(?<![\w\d])(?:^|\s)|(?<![\d])[\(\)\[\]\{\}\"'=]|(?<![\d])[#=\-\(\)\[\]\{\}\"'.,;!?]\s|:\s)1[a-km-zA-HJ-NP-Z1-9]{41,47}(?=(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)(?!\w))""",
        
        // Cosmos (ATOM) - Bech32 format (starts with cosmos1)
        """(?:(?<![\w\d])(?:^|\s)|(?<![\d])[\(\)\[\]\{\}\"'=]|(?<![\d])[#=\-\(\)\[\]\{\}\"'.,;!?]\s|:\s)cosmos1[a-z0-9]{38}(?=(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)(?!\w))""",
        
        // Tezos (XTZ) - Base58 encoded (starts with tz1, tz2, tz3, or KT1)
        """(?:(?<![\w\d])(?:^|\s)|(?<![\d])[\(\)\[\]\{\}\"'=]|(?<![\d])[#=\-\(\)\[\]\{\}\"'.,;!?]\s|:\s)(?:tz1|tz2|tz3|KT1)[a-km-zA-HJ-NP-Z1-9]{33}(?=(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)(?!\w))""",
        
        // Dash (DASH) - starts with X
        """(?:(?<![\w\d])(?:^|\s)|(?<![\d])[\(\)\[\]\{\}\"'=]|(?<![\d])[#=\-\(\)\[\]\{\}\"'.,;!?]\s|:\s)X[1-9A-HJ-NP-Za-km-z]{25,34}(?=(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)(?!\w))""",
        
        // Zcash (ZEC) - transparent addresses (starts with t1 or t3)
        """(?:(?<![\w\d])(?:^|\s)|(?<![\d])[\(\)\[\]\{\}\"'=]|(?<![\d])[#=\-\(\)\[\]\{\}\"'.,;!?]\s|:\s)t[13][a-km-zA-HJ-NP-Z1-9]{33}(?=(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)(?!\w))""",
        
        // Algorand (ALGO)
        """(?:(?<![\w\d])(?:^|\s)|(?<![\d])[\(\)\[\]\{\}\"'=]|(?<![\d])[#=\-\(\)\[\]\{\}\"'.,;!?]\s|:\s)[A-Z2-7]{58}(?=(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)(?!\w))""",
        
        // Avalanche C-Chain (same as Ethereum format, already covered)
        // Polygon (same as Ethereum format, already covered)
        // BSC (same as Ethereum format, already covered)
        
        // Terra (LUNA) - Bech32 format (starts with terra1)
        """(?:(?<![\w\d])(?:^|\s)|(?<![\d])[\(\)\[\]\{\}\"'=]|(?<![\d])[#=\-\(\)\[\]\{\}\"'.,;!?]\s|:\s)terra1[a-z0-9]{38}(?=(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)(?!\w))""",
        
        // TON (The Open Network) - Base64 format (starts with EQC, UQB, EQD, etc.)
        // Using most common prefixes to match hyperPatterns: EQC, UQB, EQD (3 chars + 41 = 44 total)
        """(?:(?<![\w\d])(?:^|\s)|(?<![\d])[\(\)\[\]\{\}\"'=]|(?<![\d])[#=\-\(\)\[\]\{\}\"'.,;!?]\s|:\s)(?:EQC|UQB|EQD)[A-Z0-9a-z+/]{41}(?=(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)(?!\w))""",
        
        // Chainlink (LINK) - same as Ethereum
        // Uniswap tokens - same as Ethereum
        // ERC-20 tokens - same as Ethereum
    )
    
    override val regexOptions = setOf(
        RegexOption.IGNORE_CASE,
        RegexOption.MULTILINE
    )

    override val hyperPatterns: List<String> = listOf(
        // Bitcoin Legacy - max quantifier = 41, lengths 25-34 (most common)
        // Split into individual patterns for each quantifier value
        // Prefix ensures not preceded by digit/alphanumeric by requiring explicit separators (HyperScan doesn't support lookbehind)
        // Fix for testBitcoinLegacyNotInNumberSequence: remove ^ from lengths 30-41 to prevent matching from start of number sequences
        // Keep ^ for lengths 25-29 to allow matching at start for testBitcoinLegacyAtStart
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[13][a-km-zA-HJ-NP-Z1-9]{25}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[13][a-km-zA-HJ-NP-Z1-9]{26}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[13][a-km-zA-HJ-NP-Z1-9]{27}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[13][a-km-zA-HJ-NP-Z1-9]{28}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[13][a-km-zA-HJ-NP-Z1-9]{29}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s)[13][a-km-zA-HJ-NP-Z1-9]{30}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s)[13][a-km-zA-HJ-NP-Z1-9]{31}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s)[13][a-km-zA-HJ-NP-Z1-9]{32}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s)[13][a-km-zA-HJ-NP-Z1-9]{33}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s)[13][a-km-zA-HJ-NP-Z1-9]{34}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s)[13][a-km-zA-HJ-NP-Z1-9]{35}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s)[13][a-km-zA-HJ-NP-Z1-9]{36}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s)[13][a-km-zA-HJ-NP-Z1-9]{37}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s)[13][a-km-zA-HJ-NP-Z1-9]{38}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s)[13][a-km-zA-HJ-NP-Z1-9]{39}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s)[13][a-km-zA-HJ-NP-Z1-9]{40}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s)[13][a-km-zA-HJ-NP-Z1-9]{41}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        
        // Bitcoin Bech32 - max quantifier = 41, lengths 39-59
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)bc1[a-z0-9]{39}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)bc1[a-z0-9]{40}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)bc1[a-z0-9]{41}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        
        // Ethereum and EVM chains - max quantifier = 200, {40} is fine
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)0x[a-fA-F0-9]{40}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        
        // Litecoin Legacy - max quantifier = 41, lengths 26-33 (most common)
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)[LM][a-km-zA-HJ-NP-Z1-9]{26}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)[LM][a-km-zA-HJ-NP-Z1-9]{27}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)[LM][a-km-zA-HJ-NP-Z1-9]{28}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)[LM][a-km-zA-HJ-NP-Z1-9]{29}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)[LM][a-km-zA-HJ-NP-Z1-9]{30}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)[LM][a-km-zA-HJ-NP-Z1-9]{31}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)[LM][a-km-zA-HJ-NP-Z1-9]{32}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)[LM][a-km-zA-HJ-NP-Z1-9]{33}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)[LM][a-km-zA-HJ-NP-Z1-9]{34}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)[LM][a-km-zA-HJ-NP-Z1-9]{35}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)[LM][a-km-zA-HJ-NP-Z1-9]{36}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)[LM][a-km-zA-HJ-NP-Z1-9]{37}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)[LM][a-km-zA-HJ-NP-Z1-9]{38}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)[LM][a-km-zA-HJ-NP-Z1-9]{39}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)[LM][a-km-zA-HJ-NP-Z1-9]{40}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)[LM][a-km-zA-HJ-NP-Z1-9]{41}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        
        // Litecoin Bech32 - max quantifier = 40, lengths 39-59
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)ltc1[a-z0-9]{39}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)ltc1[a-z0-9]{40}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        
        // Ripple - max quantifier = 41, lengths 24-34 (most common)
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)r[a-zA-Z0-9]{24}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)r[a-zA-Z0-9]{25}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)r[a-zA-Z0-9]{26}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)r[a-zA-Z0-9]{27}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)r[a-zA-Z0-9]{28}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)r[a-zA-Z0-9]{29}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)r[a-zA-Z0-9]{30}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)r[a-zA-Z0-9]{31}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)r[a-zA-Z0-9]{32}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)r[a-zA-Z0-9]{33}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)r[a-zA-Z0-9]{34}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)r[a-zA-Z0-9]{35}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)r[a-zA-Z0-9]{36}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)r[a-zA-Z0-9]{37}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)r[a-zA-Z0-9]{38}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)r[a-zA-Z0-9]{39}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)r[a-zA-Z0-9]{40}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)r[a-zA-Z0-9]{41}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        
        // Bitcoin Cash - max quantifier = 41, {41} is at limit
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)(?:bitcoincash:)?[qp][a-z0-9]{41}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        
        // Dogecoin - max quantifier = 40, {32} is fine
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)D[5-9A-HJ-NP-U][1-9A-HJ-NP-Za-km-z]{32}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        
        // Tron - max quantifier = 41, length 33 (most common)
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)T[A-Za-z1-9]{33}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)T[A-Za-z1-9]{34}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)T[A-Za-z1-9]{35}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)T[A-Za-z1-9]{36}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)T[A-Za-z1-9]{37}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)T[A-Za-z1-9]{38}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)T[A-Za-z1-9]{39}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)T[A-Za-z1-9]{40}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)T[A-Za-z1-9]{41}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        
        // Monero - max quantifier = 41, {93} too large, use {41} to cover first part only
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)[48][0-9AB][1-9A-HJ-NP-Za-km-z]{41}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        
        // Solana - max quantifier = 42, lengths 32-44
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)[1-9A-HJ-NP-Za-km-z]{32}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)[1-9A-HJ-NP-Za-km-z]{33}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)[1-9A-HJ-NP-Za-km-z]{34}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)[1-9A-HJ-NP-Za-km-z]{35}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)[1-9A-HJ-NP-Za-km-z]{36}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)[1-9A-HJ-NP-Za-km-z]{37}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)[1-9A-HJ-NP-Za-km-z]{38}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)[1-9A-HJ-NP-Za-km-z]{39}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)[1-9A-HJ-NP-Za-km-z]{40}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)[1-9A-HJ-NP-Za-km-z]{41}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)[1-9A-HJ-NP-Za-km-z]{42}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        
        // Stellar - max quantifier = 41, {55} too large, use {41} to cover first part only
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)G[A-Z0-9]{41}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        
        // Cardano - max quantifier = 40, lengths 53-104 too large
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)addr1[a-z0-9]{40}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        
        // Polkadot - max quantifier = 41, lengths 46-47 too large
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)1[a-km-zA-HJ-NP-Z1-9]{41}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        
        // Cosmos - max quantifier = 61, {38} is fine
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)cosmos1[a-z0-9]{38}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        
        // Tezos - max quantifier = 40, length 33 (most common)
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)(?:tz1|tz2|tz3|KT1)[a-km-zA-HJ-NP-Z1-9]{33}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)(?:tz1|tz2|tz3|KT1)[a-km-zA-HJ-NP-Z1-9]{34}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)(?:tz1|tz2|tz3|KT1)[a-km-zA-HJ-NP-Z1-9]{35}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)(?:tz1|tz2|tz3|KT1)[a-km-zA-HJ-NP-Z1-9]{36}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)(?:tz1|tz2|tz3|KT1)[a-km-zA-HJ-NP-Z1-9]{37}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)(?:tz1|tz2|tz3|KT1)[a-km-zA-HJ-NP-Z1-9]{38}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)(?:tz1|tz2|tz3|KT1)[a-km-zA-HJ-NP-Z1-9]{39}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)(?:tz1|tz2|tz3|KT1)[a-km-zA-HJ-NP-Z1-9]{40}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        
        // Dash - max quantifier = 41, lengths 25-34 (most common)
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)X[1-9A-HJ-NP-Za-km-z]{25}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)X[1-9A-HJ-NP-Za-km-z]{26}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)X[1-9A-HJ-NP-Za-km-z]{27}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)X[1-9A-HJ-NP-Za-km-z]{28}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)X[1-9A-HJ-NP-Za-km-z]{29}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)X[1-9A-HJ-NP-Za-km-z]{30}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)X[1-9A-HJ-NP-Za-km-z]{31}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)X[1-9A-HJ-NP-Za-km-z]{32}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)X[1-9A-HJ-NP-Za-km-z]{33}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)X[1-9A-HJ-NP-Za-km-z]{34}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)X[1-9A-HJ-NP-Za-km-z]{35}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)X[1-9A-HJ-NP-Za-km-z]{36}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)X[1-9A-HJ-NP-Za-km-z]{37}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)X[1-9A-HJ-NP-Za-km-z]{38}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)X[1-9A-HJ-NP-Za-km-z]{39}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)X[1-9A-HJ-NP-Za-km-z]{40}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)X[1-9A-HJ-NP-Za-km-z]{41}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        
        // Zcash - max quantifier = 41, length 33 (most common)
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)t[13][a-km-zA-HJ-NP-Z1-9]{33}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)t[13][a-km-zA-HJ-NP-Z1-9]{34}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)t[13][a-km-zA-HJ-NP-Z1-9]{35}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)t[13][a-km-zA-HJ-NP-Z1-9]{36}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)t[13][a-km-zA-HJ-NP-Z1-9]{37}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)t[13][a-km-zA-HJ-NP-Z1-9]{38}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)t[13][a-km-zA-HJ-NP-Z1-9]{39}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)t[13][a-km-zA-HJ-NP-Z1-9]{40}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)t[13][a-km-zA-HJ-NP-Z1-9]{41}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        
        // Algorand - max quantifier = 42, {58} too large
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)[A-Z2-7]{42}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        
        // Terra - max quantifier = 50, {38} is fine
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)terra1[a-z0-9]{38}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        
        // TON - max quantifier = 41, fixed length 48 (3 prefix + 45 base64) too large
        // Using most common prefixes: EQC, UQB, EQD
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)EQC[A-Z0-9a-z+/]{41}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)UQB[A-Z0-9a-z+/]{41}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)""",
        """(?:^|\s|[\(\)\[\]\{\}\"'=]|[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s)EQD[A-Z0-9a-z+/]{41}(?:\.\s|\.|;|\s|\r?\n|[\)\]\}\"']|$)"""
    )
    
    override val expressionOptions = setOf(
        ExpressionOption.MULTILINE,
        ExpressionOption.CASELESS,
        ExpressionOption.UTF8
    )

    override fun check(value: String): Boolean = true

    override fun toString() = name
}

