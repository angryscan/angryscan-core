package org.angryscan.common.matchers

import kotlinx.serialization.Serializable
import org.angryscan.common.engine.hyperscan.IHyperMatcher
import org.angryscan.common.engine.ExpressionOption
import org.angryscan.common.engine.kotlin.IKotlinMatcher

@Serializable
object CryptoWallet : IHyperMatcher, IKotlinMatcher {
    override val name = "Crypto Wallet Address"
    
    override val javaPatterns = listOf(
        // Bitcoin (BTC) - Legacy P2PKH/P2SH addresses (starts with 1 or 3)
        """(?<![\w])(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[13][a-km-zA-HJ-NP-Z1-9]{25,34}(?=(?:\.\s|\s|\r?\n|[\)\]\}]\s)(?!\w))""",
        
        // Bitcoin (BTC) - Bech32 addresses (starts with bc1)
        """(?<![\w])(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))bc1[a-z0-9]{39,59}(?=(?:\.\s|\s|\r?\n|[\)\]\}]\s)(?!\w))""",
        
        // Ethereum (ETH) and EVM-compatible chains (Polygon, BSC, Avalanche, etc.)
        """(?<![\w])(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))0x[a-fA-F0-9]{40}(?=(?:\.\s|\s|\r?\n|[\)\]\}]\s)(?!\w))""",
        
        // Litecoin (LTC) - Legacy addresses
        """(?<![\w])(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[LM][a-km-zA-HJ-NP-Z1-9]{26,33}(?=(?:\.\s|\s|\r?\n|[\)\]\}]\s)(?!\w))""",
        
        // Litecoin (LTC) - Bech32 addresses (starts with ltc1)
        """(?<![\w])(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))ltc1[a-z0-9]{39,59}(?=(?:\.\s|\s|\r?\n|[\)\]\}]\s)(?!\w))""",
        
        // Ripple (XRP)
        """(?<![\w])(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))r[a-zA-Z0-9]{24,34}(?=(?:\.\s|\s|\r?\n|[\)\]\}]\s)(?!\w))""",
        
        // Bitcoin Cash (BCH) - Legacy format
        """(?<![\w])(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))(?:bitcoincash:)?[qp][a-z0-9]{41}(?=(?:\.\s|\s|\r?\n|[\)\]\}]\s)(?!\w))""",
        
        // Bitcoin Cash (BCH) - CashAddr format
        """(?<![\w])(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))(?:bitcoincash:)?[qp][a-z]{10}[0-9a-z]{31}(?=(?:\.\s|\s|\r?\n|[\)\]\}]\s)(?!\w))""",
        
        // Dogecoin (DOGE)
        """(?<![\w])(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))D[5-9A-HJ-NP-U][1-9A-HJ-NP-Za-km-z]{32}(?=(?:\.\s|\s|\r?\n|[\)\]\}]\s)(?!\w))""",
        
        // Tron (TRX)
        """(?<![\w])(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))T[A-Za-z1-9]{33}(?=(?:\.\s|\s|\r?\n|[\)\]\}]\s)(?!\w))""",
        
        // Monero (XMR) - Standard address (95 characters)
        """(?<![\w])(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[48][0-9AB][1-9A-HJ-NP-Za-km-z]{93}(?=(?:\.\s|\s|\r?\n|[\)\]\}]\s)(?!\w))""",
        
        // Solana (SOL) - Base58 encoded
        """(?<![\w])(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[1-9A-HJ-NP-Za-km-z]{32,44}(?=(?:\.\s|\s|\r?\n|[\)\]\}]\s)(?!\w))""",
        
        // Stellar (XLM)
        """(?<![\w])(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))G[A-Z0-9]{55}(?=(?:\.\s|\s|\r?\n|[\)\]\}]\s)(?!\w))""",
        
        // Cardano (ADA) - Bech32 format (starts with addr1)
        """(?<![\w])(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))addr1[a-z0-9]{53,104}(?=(?:\.\s|\s|\r?\n|[\)\]\}]\s)(?!\w))""",
        
        // Polkadot (DOT) - SS58 format
        """(?<![\w])(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))1[a-km-zA-HJ-NP-Z1-9]{46,47}(?=(?:\.\s|\s|\r?\n|[\)\]\}]\s)(?!\w))""",
        
        // Cosmos (ATOM) - Bech32 format (starts with cosmos1)
        """(?<![\w])(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))cosmos1[a-z0-9]{38}(?=(?:\.\s|\s|\r?\n|[\)\]\}]\s)(?!\w))""",
        
        // Tezos (XTZ) - Base58 encoded (starts with tz1, tz2, tz3, or KT1)
        """(?<![\w])(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))(?:tz1|tz2|tz3|KT1)[a-km-zA-HJ-NP-Z1-9]{33}(?=(?:\.\s|\s|\r?\n|[\)\]\}]\s)(?!\w))""",
        
        // Dash (DASH) - starts with X
        """(?<![\w])(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))X[1-9A-HJ-NP-Za-km-z]{25,34}(?=(?:\.\s|\s|\r?\n|[\)\]\}]\s)(?!\w))""",
        
        // Zcash (ZEC) - transparent addresses (starts with t1 or t3)
        """(?<![\w])(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))t[13][a-km-zA-HJ-NP-Z1-9]{33}(?=(?:\.\s|\s|\r?\n|[\)\]\}]\s)(?!\w))""",
        
        // Algorand (ALGO)
        """(?<![\w])(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[A-Z2-7]{58}(?=(?:\.\s|\s|\r?\n|[\)\]\}]\s)(?!\w))""",
        
        // Avalanche C-Chain (same as Ethereum format, already covered)
        // Polygon (same as Ethereum format, already covered)
        // BSC (same as Ethereum format, already covered)
        
        // Terra (LUNA) - Bech32 format (starts with terra1)
        """(?<![\w])(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))terra1[a-z0-9]{38}(?=(?:\.\s|\s|\r?\n|[\)\]\}]\s)(?!\w))""",
        
        // TON (The Open Network) - Base64 format (starts with EQC, UQB, EQD, etc.)
        """(?<![\w])(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[E-U][Q-Z][A-Z0-9a-z+/]{43}(?=(?:\.\s|\s|\r?\n|[\)\]\}]\s)(?!\w))""",
        
        // Chainlink (LINK) - same as Ethereum
        // Uniswap tokens - same as Ethereum
        // ERC-20 tokens - same as Ethereum
    )
    
    override val regexOptions = setOf(
        RegexOption.IGNORE_CASE,
        RegexOption.MULTILINE
    )

    override val hyperPatterns: List<String> = listOf(
        // Bitcoin Legacy - max quantifier = 41, lengths 25-34 (most common)
        // Split into individual patterns for each quantifier value
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[13][a-km-zA-HJ-NP-Z1-9]{25}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[13][a-km-zA-HJ-NP-Z1-9]{26}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[13][a-km-zA-HJ-NP-Z1-9]{27}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[13][a-km-zA-HJ-NP-Z1-9]{28}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[13][a-km-zA-HJ-NP-Z1-9]{29}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[13][a-km-zA-HJ-NP-Z1-9]{30}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[13][a-km-zA-HJ-NP-Z1-9]{31}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[13][a-km-zA-HJ-NP-Z1-9]{32}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[13][a-km-zA-HJ-NP-Z1-9]{33}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[13][a-km-zA-HJ-NP-Z1-9]{34}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[13][a-km-zA-HJ-NP-Z1-9]{35}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[13][a-km-zA-HJ-NP-Z1-9]{36}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[13][a-km-zA-HJ-NP-Z1-9]{37}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[13][a-km-zA-HJ-NP-Z1-9]{38}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[13][a-km-zA-HJ-NP-Z1-9]{39}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[13][a-km-zA-HJ-NP-Z1-9]{40}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[13][a-km-zA-HJ-NP-Z1-9]{41}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        
        // Bitcoin Bech32 - max quantifier = 41, lengths 39-59
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))bc1[a-z0-9]{39}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))bc1[a-z0-9]{40}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))bc1[a-z0-9]{41}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        
        // Ethereum and EVM chains - max quantifier = 200, {40} is fine
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))0x[a-fA-F0-9]{40}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        
        // Litecoin Legacy - max quantifier = 41, lengths 26-33 (most common)
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[LM][a-km-zA-HJ-NP-Z1-9]{26}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[LM][a-km-zA-HJ-NP-Z1-9]{27}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[LM][a-km-zA-HJ-NP-Z1-9]{28}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[LM][a-km-zA-HJ-NP-Z1-9]{29}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[LM][a-km-zA-HJ-NP-Z1-9]{30}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[LM][a-km-zA-HJ-NP-Z1-9]{31}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[LM][a-km-zA-HJ-NP-Z1-9]{32}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[LM][a-km-zA-HJ-NP-Z1-9]{33}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[LM][a-km-zA-HJ-NP-Z1-9]{34}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[LM][a-km-zA-HJ-NP-Z1-9]{35}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[LM][a-km-zA-HJ-NP-Z1-9]{36}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[LM][a-km-zA-HJ-NP-Z1-9]{37}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[LM][a-km-zA-HJ-NP-Z1-9]{38}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[LM][a-km-zA-HJ-NP-Z1-9]{39}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[LM][a-km-zA-HJ-NP-Z1-9]{40}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[LM][a-km-zA-HJ-NP-Z1-9]{41}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        
        // Litecoin Bech32 - max quantifier = 40, lengths 39-59
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))ltc1[a-z0-9]{39}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))ltc1[a-z0-9]{40}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        
        // Ripple - max quantifier = 41, lengths 24-34 (most common)
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))r[a-zA-Z0-9]{24}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))r[a-zA-Z0-9]{25}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))r[a-zA-Z0-9]{26}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))r[a-zA-Z0-9]{27}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))r[a-zA-Z0-9]{28}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))r[a-zA-Z0-9]{29}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))r[a-zA-Z0-9]{30}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))r[a-zA-Z0-9]{31}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))r[a-zA-Z0-9]{32}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))r[a-zA-Z0-9]{33}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))r[a-zA-Z0-9]{34}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))r[a-zA-Z0-9]{35}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))r[a-zA-Z0-9]{36}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))r[a-zA-Z0-9]{37}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))r[a-zA-Z0-9]{38}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))r[a-zA-Z0-9]{39}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))r[a-zA-Z0-9]{40}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))r[a-zA-Z0-9]{41}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        
        // Bitcoin Cash - max quantifier = 41, {41} is at limit
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))(?:bitcoincash:)?[qp][a-z0-9]{41}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        
        // Dogecoin - max quantifier = 40, {32} is fine
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))D[5-9A-HJ-NP-U][1-9A-HJ-NP-Za-km-z]{32}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        
        // Tron - max quantifier = 41, length 33 (most common)
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))T[A-Za-z1-9]{33}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))T[A-Za-z1-9]{34}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))T[A-Za-z1-9]{35}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))T[A-Za-z1-9]{36}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))T[A-Za-z1-9]{37}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))T[A-Za-z1-9]{38}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))T[A-Za-z1-9]{39}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))T[A-Za-z1-9]{40}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))T[A-Za-z1-9]{41}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        
        // Monero - max quantifier = 41, {93} too large, use {41} to cover first part only
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[48][0-9AB][1-9A-HJ-NP-Za-km-z]{41}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        
        // Solana - max quantifier = 42, lengths 32-44
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[1-9A-HJ-NP-Za-km-z]{32}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[1-9A-HJ-NP-Za-km-z]{33}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[1-9A-HJ-NP-Za-km-z]{34}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[1-9A-HJ-NP-Za-km-z]{35}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[1-9A-HJ-NP-Za-km-z]{36}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[1-9A-HJ-NP-Za-km-z]{37}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[1-9A-HJ-NP-Za-km-z]{38}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[1-9A-HJ-NP-Za-km-z]{39}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[1-9A-HJ-NP-Za-km-z]{40}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[1-9A-HJ-NP-Za-km-z]{41}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[1-9A-HJ-NP-Za-km-z]{42}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        
        // Stellar - max quantifier = 41, {55} too large, use {41} to cover first part only
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))G[A-Z0-9]{41}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        
        // Cardano - max quantifier = 40, lengths 53-104 too large
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))addr1[a-z0-9]{40}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        
        // Polkadot - max quantifier = 41, lengths 46-47 too large
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))1[a-km-zA-HJ-NP-Z1-9]{41}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        
        // Cosmos - max quantifier = 61, {38} is fine
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))cosmos1[a-z0-9]{38}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        
        // Tezos - max quantifier = 40, length 33 (most common)
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))(?:tz1|tz2|tz3|KT1)[a-km-zA-HJ-NP-Z1-9]{33}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))(?:tz1|tz2|tz3|KT1)[a-km-zA-HJ-NP-Z1-9]{34}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))(?:tz1|tz2|tz3|KT1)[a-km-zA-HJ-NP-Z1-9]{35}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))(?:tz1|tz2|tz3|KT1)[a-km-zA-HJ-NP-Z1-9]{36}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))(?:tz1|tz2|tz3|KT1)[a-km-zA-HJ-NP-Z1-9]{37}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))(?:tz1|tz2|tz3|KT1)[a-km-zA-HJ-NP-Z1-9]{38}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))(?:tz1|tz2|tz3|KT1)[a-km-zA-HJ-NP-Z1-9]{39}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))(?:tz1|tz2|tz3|KT1)[a-km-zA-HJ-NP-Z1-9]{40}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        
        // Dash - max quantifier = 41, lengths 25-34 (most common)
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))X[1-9A-HJ-NP-Za-km-z]{25}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))X[1-9A-HJ-NP-Za-km-z]{26}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))X[1-9A-HJ-NP-Za-km-z]{27}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))X[1-9A-HJ-NP-Za-km-z]{28}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))X[1-9A-HJ-NP-Za-km-z]{29}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))X[1-9A-HJ-NP-Za-km-z]{30}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))X[1-9A-HJ-NP-Za-km-z]{31}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))X[1-9A-HJ-NP-Za-km-z]{32}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))X[1-9A-HJ-NP-Za-km-z]{33}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))X[1-9A-HJ-NP-Za-km-z]{34}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))X[1-9A-HJ-NP-Za-km-z]{35}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))X[1-9A-HJ-NP-Za-km-z]{36}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))X[1-9A-HJ-NP-Za-km-z]{37}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))X[1-9A-HJ-NP-Za-km-z]{38}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))X[1-9A-HJ-NP-Za-km-z]{39}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))X[1-9A-HJ-NP-Za-km-z]{40}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))X[1-9A-HJ-NP-Za-km-z]{41}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        
        // Zcash - max quantifier = 41, length 33 (most common)
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))t[13][a-km-zA-HJ-NP-Z1-9]{33}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))t[13][a-km-zA-HJ-NP-Z1-9]{34}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))t[13][a-km-zA-HJ-NP-Z1-9]{35}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))t[13][a-km-zA-HJ-NP-Z1-9]{36}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))t[13][a-km-zA-HJ-NP-Z1-9]{37}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))t[13][a-km-zA-HJ-NP-Z1-9]{38}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))t[13][a-km-zA-HJ-NP-Z1-9]{39}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))t[13][a-km-zA-HJ-NP-Z1-9]{40}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))t[13][a-km-zA-HJ-NP-Z1-9]{41}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        
        // Algorand - max quantifier = 42, {58} too large
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))[A-Z2-7]{42}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        
        // Terra - max quantifier = 50, {38} is fine
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))terra1[a-z0-9]{38}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        
        // TON - max quantifier = 41, fixed length 48 (3 prefix + 45 base64) too large
        // Using most common prefixes: EQC, UQB, EQD
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))EQC[A-Z0-9a-z+/]{41}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))UQB[A-Z0-9a-z+/]{41}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)""",
        """(?:^|(?:[#:=\-\(\)\[\]\{\}\"'.,;:!?]\s|\s))EQD[A-Z0-9a-z+/]{41}(?:\.\s|\s|\r?\n|[\)\]\}]\s|$)"""
    )
    
    override val expressionOptions = setOf(
        ExpressionOption.MULTILINE,
        ExpressionOption.CASELESS,
        ExpressionOption.UTF8
    )

    override fun check(value: String): Boolean = true

    override fun toString() = name
}

